name: sync
on:
  schedule:
  - cron: '*/30 * * * *'
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]
jobs:
  build:
    runs-on: centos:8
    strategy:
     matrix:
        syncs:
          - 'docker.io/labring/kubernetes-docker'
          - 'docker.io/labring/kubernetes'
          - 'docker.io/labring/helm'
          - 'docker.io/labring/flannel'
          - 'docker.io/labring/calico'
          - 'docker.io/library/ubuntu'
          - 'docker.io/library/centos'
          - 'docker.io/mydlqclub/dnsutils'
          - 'docker.io/bitnami/etcd'
          - 'docker.io/apache/apisix'
          - 'docker.io/flannel/flannel-cni-plugin'
          - 'docker.io/flannel/flannel'
    steps:
    - name: Checkout
      uses: actions/checkout@v2
    - name: 'update'
      run: yum update -y && yum install skopeo -y
    - name: 'login'
      run: skopeo login -u ${{ secrets.REGISTERY_USERNAME }} registry.cn-hangzhou.aliyuncs.com -p "${{ secrets.REGISTERY_PASSWORD }}"
    - name: sync
      run: python sync.py ${{ matrix.syncs }} -v

